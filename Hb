local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "UD HB",
    LoadingTitle = "UD HB",
    LoadingSubtitle = "by G9cx",
    ConfigurationSaving = {
        Enabled = true,
        FileName = "HitboxConfig"
    },
    ToggleUIKeybind = Enum.KeyCode.F8,
    KeySystem = false
})

local Tab = Window:CreateTab("Main", nil)

local enabled = false
local sizeValue = 6
local transparencyValue = 0.4
local seeHitbox = false

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Function to set all parts non-collidable but maintain hitbox
local function setAllPartsNonCollidable(character)
    for _, part in pairs(character:GetChildren()) do
        if part:IsA("BasePart") then
            part.CanCollide = false
            part.CanTouch = true
            part.CanQuery = true
        end
    end
end

-- Function to update players' hitboxes
local function UpdatePlayers()
    if not enabled then return end

    local trans = seeHitbox and 0 or transparencyValue

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local Root = player.Character:FindFirstChild("HumanoidRootPart")
            if Root then
                local Size = Vector3.new(sizeValue, sizeValue, sizeValue)
                if Root:IsA("BasePart") then
                    Root.Size = Size
                    Root.Transparency = trans
                    Root.CanCollide = false
                    Root.CanTouch = true
                    Root.CanQuery = true
                end
            end
            setAllPartsNonCollidable(player.Character)
        end
    end
end

-- Master Toggle
Tab:CreateToggle({
    Name = "Enable Hitbox Expander",
    CurrentValue = false,
    Flag = "EnableHitbox",
    Callback = function(Value)
        enabled = Value
        if enabled then
            UpdatePlayers()
        else
            -- Reset if disabled
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character then
                    local Root = player.Character:FindFirstChild("HumanoidRootPart")
                    if Root then
                        Root.Size = Vector3.new(4, 2, 1) -- Default HRP size, adjust if needed
                        Root.Transparency = 1
                        Root.CanCollide = true
                    end
                end
            end
        end
    end
})

-- Size Slider
Tab:CreateSlider({
    Name = "Hitbox Size (studs)",
    Range = {1, 15},
    Increment = 1,
    Suffix = "studs",
    CurrentValue = 6,
    Flag = "HitboxSize",
    Callback = function(Value)
        sizeValue = Value
        UpdatePlayers()
    end
})

-- Transparency Slider (0 = opaque, 1 = invisible)
Tab:CreateSlider({
    Name = "Hitbox Transparency",
    Range = {0, 1},
    Increment = 0.1,
    Suffix = "",
    CurrentValue = 0.4,
    Flag = "HitboxTransparency",
    Callback = function(Value)
        transparencyValue = Value
        UpdatePlayers()
    end
})

-- See Hitbox Toggle
Tab:CreateToggle({
    Name = "See Hitbox (Visible)",
    CurrentValue = false,
    Flag = "SeeHitbox",
    Callback = function(Value)
        seeHitbox = Value
        UpdatePlayers()
    end
})

-- Auto-update connections
Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        wait(1)
        UpdatePlayers()
    end)
end)

Players.PlayerRemoving:Connect(function()
    wait(1)
    UpdatePlayers()
end)

-- Periodic update
spawn(function()
    while true do
        wait(5)
        UpdatePlayers()
    end
end)

setfpscap(1000000)
